%===============================================================================
\chapter{Úvod}

Dnešní doba poskytuje mnoho možností, jak si svůj vyvíjený produkt, nebo například jen pouhou hypotézu toho, jak by nějaký systém mohl fungovat, namodelovat a provést na tomto modelu simulaci \cite{NEGRAO20113051}. Z~takto provedené simulace získáme představu o~tom, jak se náš produkt chová. A~pro tyto simulace je potřeba zvolit vhodný simulační nástroj. Vhodně zvolený simulační nástroj může totiž ušetřit nemalé prostředky při uvedení produktu na trh právě díky proběhnutí simulací a odlazením celého procesu chodu produktu \cite{cohen2010cost}. Proto je vhodné věnovat čas simulaci dostatečný čas. Simulační nástroje jsou implementovány nad různými jazyky, ale pro účely práce byly zvoleny primárně dvě hlavní rodiny jazyků - MATLAB a Modelica, případně jazyky, které jsou na nich založené a jsou většinově kompatibilní. Zároveň je pro porovnání vybrán jazyk Python s~rozšířeními SciPy a NumPy, který není příbuzný s~výše uvedenými jazyky.

Cílem této bakalářské práce je provést srovnání volně dostupných simulačních nástrojů. Pro účely porovnání budou implementovány simulační modely v~různých simulačních jazycích. Tyto modely budou následně porovnány pomocí porovnávací metodiky a získané výsledky srovnání budou použity k~pojednání o~vhodnosti použití implementovaných modelů pro zvolené nástroje.

V~kapitole \ref{kapitola2} budou popsány a vysvětleny důležité pojmy potřebné pro pochopení problematiky modelování a simulací. Zároveň v~této kapitole bude vysvětlena problematiky porovnání a popsána zvolená porovnávací metodika. Dále bude kapitola pojednávat o~použitých simulačních nástrojích a jejich jazycích. Kapitola \ref{kapitola4} bude obsahovat popis implementovaných simulačních modelů pro simulační nástroje. Společně s implementací bude v této kapitole popsána porovnávací metodika. Poslední kapitola \ref{kapitola5} bude obsahovat výsledky porovnání simulačních nástrojů zároveň s~popisem způsobilosti použitých modelů pro využité nástroje.

\chapter{Modelování a simulace}
\label{kapitola2}

Modelování a simulace jsou dnes již nedílnou součástí vědy a výzkumu. Tato kapitola se věnuje vysvětlení pojmů nutných k pochopení základní problematiky modelování a simulací. Dále lze v kapitole nalézt popis výhod a nevýhod použití simulací. Poslední podkapitola se věnuje popisu programovacích jazyků využitých pro účely bakalářské práce.

\section{Problematika modelování a simulací}
Jelikož jsou modelování a simulace velmi komplexní disciplíny, je nutné si stanovit, alespoň v~jednoduchosti, základní pojmy, které jsou v~rámci této práce využívány.

\subsection{Modelování a model}
\label{modelovani}
Modelování je vědecká disciplína, při které dochází k~popisu systému většinou z~reálného světa a získání všech možných informací, které k~tomuto systému máme. Ze získaných poznatků se vytvoří model. V~rámci zkoumání získaných informací je nutná analýza možných nepochopitelných a nepopsatelných vlastností modelu. Model je tedy jen přiblížení se ke skutečnosti, nikoliv její dokonalý odraz. Modely lze dělit podle jejich chování na:

\begin{itemize}
    \item spojité -- hodnoty modelu se v~průběhu simulace mění spojitě. Tyto modely jsou popsatelné diferenciálními rovnicemi
    \item diskrétní -- hodnoty modelu se v~průběhu simulace mění skokově. Tyto modely lze popsat jako konečný, nebo celulární automat
    \item kombinované -- tyto modely obsahují společně spojité a diskrétní složky vedle sebe
\end{itemize}

V~literatuře můžeme nalézt další možné rozdělení modelů \cite{IMS-skripta}.
\newline

S~takto popsanými modely je pak možné vykonávat simulace. Během simulace se pozoruje chování modelu, vyhodnocují se výsledky simulací a případně se mění popis modelu, pokud to vyžaduje simulace, nebo pokud se přijde na nové, nečekané chování.

Model je také možné vytvářet pomocí tzv. "nereálného"\space systému. Takové systémy jsou často k~nalezení v~počítačových hrách, případně ve vědeckých oborech, kde jsou získané poznatky o~systému velmi omezené.

\subsection{Systém}
Systém je možno definovat jako soustavu částic, které na sebe vzájemně působí. Systémy se mohou dělit na:

\begin{itemize}
    \item Otevřené a uzavřené -- podle jejich interakce s~okolním prostředím
    \item Spojité a diskrétní -- podle toho, zda se hodnoty systému mění spojitě, nebo skokově
    \item Statické a dynamické -- podle toho, zda se systém vyvíjí v~čase
\end{itemize}
Pro potřeby simulací jsou využívány především dynamické systémy, u~kterých můžeme sledovat jejich vývoj v~průběhu simulace.

\subsection{Simulace}
Simulace je disciplína zabývající se získáváním informací z~modelů pomocí provádění experimentů s~nimi. Pro získání validních informací o~modelu je potřeba provést simulaci vícekrát a následně porovnat a vyhodnotit výsledné hodnoty.

Před během simulace a po vyhodnocení výsledků je vhodné provést analýzu vhodnosti modelu pro simulaci. Pokud shledáme model nevalidním, není vhodný pro náš záměr a je záhodno jej z~dalších simulací vyřadit.


Simulace můžeme rozdělovat podle mnoha kritérii:
\begin{enumerate}
    \item Podle typu použitého modelu:
        \begin{itemize}
            \item Spojitá -- rozdělení je závislé podle typu použitého modelu, viz \ref{modelovani}
            \item Diskrétní
            \item Kombinovaná
        \end{itemize}
    \item Podle zpracování výsledků:
        \begin{itemize}
            \item Kvalitativní -- v~rámci kvalitativní metody nevnímáme model jako komplexní objekt, ale zaměřujeme se pouze na pár vybraných kvalit
            \item Kvantitativní -- tato metoda zpracování je vhodná pro modely, které neumíme přesně zapsat a popsat
        \end{itemize}
    \item Podle rozložení výpočtů:
        \begin{itemize}
            \item Simulace na jednom stroji -- pro účely výpočtu je využit jen jeden výpočetní stroj (procesor, cluster). Toto využití je vhodné pro simulace jednoduššího rázu.
            \item Paralelní a distribuovaná simulace -- simulace probíhá na více strojích zároveň. Pomocí dílčího rozdělení výpočtů můžeme dosáhnout značného zrychlení v~případě složitých simulací, např. lety do kosmu.
        \end{itemize}
\end{enumerate}
Další a mnohá rozdělení simulací můžeme nalézt v~literatuře. Pro účely různých druhů simulací jsou rozdělení jiná, nemluvě o~dynamickém vývoji tohoto odvětví a tudíž i neustálým změnám v~rozdělení simulací.

V této bakalářské práci se věnuji pouze simulacím spojitým a kombinovaným. Diskrétní simulace, které simulují například systémy hromadné obsluhy, výrobní linky a obchody, v této bakalářské práci řešeny nebudou. 

\section{Postup modelování a simulace}
Jak už bylo řečeno v~kapitole \ref{modelovani}, modely jsou tvořeny pomocí pozorování systému a získávání poznatků o~něm. Pro účely popisu tvoření modelu budeme vycházet z~předpokladu, že pozorujeme tzv. "reálný"\space systém. Na základě získaných reálií o~systému vytvoříme abstraktní model, který je vlastně "zjednodušenina" pozorovaného systému, díky tomu, že pracujeme pouze s~daty, která získáme pomocí pozorování. Takto vytvořený model může být popsán například diferenciálními rovnicemi.

Z~takto popsaného abstraktního modelu dále vytvoříme simulační model. Simulační model je vlastně přepis abstraktního modelu do programovacího jazyka tak, abychom byli schopni s~tímto modelem provádět měření a experimenty. Simulační model je tedy program/skript, který počítá výsledky podle zadaných vstupních hodnot, počátečního stavu, parametrů modelu a případných proměnných.

S~výsledky získanými ze simulačního modelu získáváme další poznatky o~chování abstraktního modelu. Tyto získané výsledky můžeme využít pro upravení abstraktního modelu, následně upravení simulačního modelu podle modelu abstraktního a opětovnému provedení simulace \cite{IMS-skripta}.

Výsledky je vhodné vizualizovat tak, abychom mohli s~nimi dále pracovat a analyzovat je. V~rámci analýzy je potřeba rozlišit s~jakým typem dat pracuji a podle toho zvolit metodu, pomocí které budu analýzu provádět. Mezi běžné druhy analýzy výsledků patří:
\begin{itemize}
    \item Porovnání získaných výsledků s~reálnými naměřenými daty daného systému
    \item Použití statistických metod pro zpracování výsledků
    \item Automatické vyhodnocení výsledků simulace podle metodiky zvoleného simulačního nástroje
\end{itemize}

V~rámci simulace můžeme sledovat i hodnoty, které nepřímo souvisí s~výsledkem simulace. Mezi tyto hodnoty patří například:
\begin{itemize}
    \item Strojový čas -- čas po který simulace využívá výpočetní stroj
    \item Přesnost numerické metody -- mění se v~závislosti na použité numerické metodě
    \item Alokace zdrojů při simulaci -- využití fyzických a virtuálních zdrojů výpočetního stroje
\end{itemize}

Část z~těchto proměnných budeme sledovat v~rámci této bakalářské práce. Popis sledování a následného porovnání lze nalézt v~kapitole \ref{kapitola4}.

\section{Výhody a nevýhody využití simulací}

Jako všechny procesy, tak i simulace mají své pozitivní i negativní vlastnosti. V~jednoduchosti se dá říct, že simulace šetří čas a peníze, ale na druhou stranu mohou stát mnoho zdrojů (peníze a čas) pro to, aby vůbec byly vytvořeny a uskutečněny podle reálného podkladu.

\subsection{Výhody využití simulací}
\label{vyhody}
Jak už bylo zmíněno výše, hlavními výhodami jsou ušetření času a ceny experimentu. Dále to pak mohou být bezpečnost, replikovatelnost a rychlost. Bližší popis výhod:

\begin{enumerate}
    \item Cena je v~dnešní době velmi důležitým faktorem pro potřeby simulací, protože experimenty s~reálným systémem mohou být velmi drahé. Díky využití modelů a simulací je možné výrazně ušetřit na výrobě testovacích kusů. Toto je velmi patrné například v~leteckém průmyslu - reálné systémy (letadla, jejich komponenty) se zde využívají až pro validaci výsledků předchozích simulací.
    \item Rychlost je dalším z~kritérií pro běh simulací. V~závislosti na výkonu výkonu stroje, který simulaci vykonává, můžeme simulaci zpomalovat a zrychlovat dle našich potřeb. Důležitým faktorem je zde výkon výpočetního zdroje, který nám omezuje maximální (minimální) rychlost simulace. Dobrým příkladem pro nutnost zrychlování simulace je sledování pohybu litosferických desek. Tento pohyb je v~reálném systému velmi pomalý, ale pokud máme dostatečně výkonný výpočetní stroj, můžeme simulaci zrychlit a dosáhnout výsledků o~mnoho dříve.
    \item Replikovatelnost je faktor, který velmi úzce souvisí s~cenou simulace. Pomocí simulace můžeme provést výpočty na jednom modelu prakticky nekonečně mnohokrát bez potřeby využití reálného systému. Pomocí replikovatelnosti jsme schopni dosáhnout přesnějších výsledků a tím pádem i větši znalosti vlastností objektů \cite{belanger2010and}.
    \item Bezpečnost je další faktor, který je velkou výhodou využití simulací. Některé experimenty s~reálnými systémy není možné z~bezpečnostních důvodů vůbec provádět - například crash testy letadel, nebo simulace chemických a jaderných reakcí, případně simulace epidemií různých nemocí.
    \item V~neposlední řadě je to možnost experimentovat se systémy, které můžeme blíže zkoumat právě jen díky provádění simulací s~nimi - například kolize vesmírných těles, působení černých děr \cite{Fragile_2007}, apod.
\end{enumerate}

Tento výpis výhod simulací rozhodně není konečný. Je velmi pravděpodobné, že se v~blízké době objeví další velká výhoda tohoto procesu. Jelikož výpočetní výkon počítačů neustále roste podle Moorova zákona \cite{Schaller1997}, časem bude možné provádět experimenty s~daleko složitějšími modely než doposud. Výsledky simulací se využívají mimo vědu také pro populárně naučné účely, případně pro potřeby využití ve filmovém a herním průmyslu \cite{James_2015}.

\subsection{Nevýhody využití simulací}

Stejně tak, jako simulace mohou šetřit naše zdroje, při nesprávném vymodelování modelu, případně nesprávném zavedení simulací, se mohou velmi prodražit a prodloužit časy simulací. Se simulacemi se samozřejmě pojí více problémů, než jen peníze a čas:

\begin{enumerate}
    \item Velké nároky na výpočetní výkon je běžný problém všech výpočetních operací. S~rostoucími nároky na rychlost a výsledky simulací přímo uměrně roste také nárok na výkon simulačního stroje. Nicméně díky zvětšování výkonu v~závislosti na Moorovu zákonu, viz kapitola \ref{vyhody}, je možné provádět složitější výpočetní operace i na běžných osobních počítačích a ne pouze na sálových superpočítačích, jako tomu bylo dříve.
    \item Během simulace může docházet k~chybám kvůli nevhodně zvolené numerické metodě, případně kvůli její nepřesnosti řešení. Tento stav dokáže ovlivnit i relativně bezchybně namodelovaný model a znehodnotit tak výsledky z~experimentů s~ním.
    \item Velká časová náročnost v~případě, že chceme simulaci provést vícekrát. Tento problém je spjatý i s~nároky na výpočetní výkon -- je-li výkon dostatečný, můžeme simulaci urychlit a tím i zkrátit čas simulace.
    \item Velmi důležitým problémem je problém ověřování validity. Pokud máme chybně namodelovaný model, pak výsledky simulace obsahují také chyby a tedy model není validní. Ověřování validity modelu by mělo proběhnout ještě před provedením simulace, tak, abychom předešli jeho následnému přemodelování.
\end{enumerate}

Stejně jako u~výhod simulací v~kapitole \ref{vyhody} není tento výčet konečný. Další velkou nevýhodou je například vysoká složitost vytvoření modelu. A~stejně jako u~výhod, i zde je velmi pravděpodobné, že se další velké nevýhody budou objevovat s~přibývajícím časem.

\section{Popis použitých jazyků}
\label{popis-jazyky}
Jazyků umožňujících vytváření a specifikaci modelů a provádení experimentů s~nimi je na trhu nepřeberné množství \cite{list-of-process-modelling-lang}. Tyto jazyky se také liší v~případech využití - pro různé typy modelů a simulací systémů jsou jinak vhodné. Pro potřeby bakalářské práce jsem si zvolil tři programovací jazyky, z~toho dva z~kategorie jazyků, které jsou využívány vybranými volně dostupnými simulačními nástroji. Nástroje tyto jazyky používají buď v~čisté formě, případně jejich modifikované verze určené pro konkrétní nástroj. Těmito jazyky jsou MATLAB\cite{MATLAB:2010} a Modelica\cite{Fritzson02modelica--}. Jako třetí programovací jazyk byl pro porovnání zvolen jazyk Python s~podporou matematických, vědeckých a simulačních knihoven a knihoven pro tvorbu grafů \cite{scipy}. 

Simulačních jazyků, jejich modifikací a nástrojů, které je následně využívají, je nespočet \cite{list}. Z těch nejznámějších to je například FORTRAN, který posloužil jako základ pro jazyk MATLAB, dále pak třeba SIMULA a Smile. Výše zvolené jazyky (MATLAB, Modelica, Python) byly zvoleny kvůli jejich rozšířenosti, díky které existuje mnoho nástrojů, které tuto trojici jazyků využívají.

\subsection{MATLAB}
\label{matlab-lang}
Jazyk MATLAB je uzavřený skriptovací jazyk, který je vyvíjený a spravovaný firmou MathWorks od roku 1984. Tento jazyk je spjatý se stejnojmenným nástrojem MATLAB. Jazyk je využíván k~popisu analýzy dat, k~návrhu a implementaci algoritmů a také k~vytváření modelů a provádění operací (simulací) s~nimi. Jazyk MATLAB se vyznačuje velmi slabou typovou kontrolu a také tím, že se všemi objekty je pracováno jako s~maticemu, v~případě jednořádkové matice, vektoru, je s~práce s~touto maticí shodná s~prací s~polem hodnot. Většina vestavěných funkcí je pro tento účel naprogramována a očekává na svém vstupu právě matici. Syntax zápisu kódu v~MATLABu připomíná kterýkoliv jiný funkcionální jazyk. Jazyk MATLAB podporuje také objektově orientované programování. Pro účely zpracování a analýzy získaných výsledků dává jazyk možnost vykreslit grafy. Všechny výsledky simulací v~této práci, které jsou provedeny v~MATLABu, mají vykreslené grafy právě tímto nástrojem. Výsledky můžete nalézt v~kapitole \ref{kapitola5}. Prostředí MATLABu je navrženo tak, že navíc dokáže pracovat s~funkcemi napsanými v~jazyce C a Fortran. Zároveň má jazyk možnost využít knihovny napsané v~jiných jazycích, jako jsou například Java, .NET nebo Perl.

Tento programovací jazyk byl vybrán kvůli rozšířenosti na středních a vysokých školách, ale také na různých pracovištích zabývajícími se modelováním a simulacemi. Navzdory tomu, že nástroj MATLAB není volně dostupný, na trhu jsou k~dostání volně dostupné nástroje, jako například GNU Octave a SciLab, které jsou s~jazykem MATLAB do určité míry kompatibilní. Dále pro MATLAB existuje rozšíření SIMULINK, které do prostředí MATLABu přidává možnost provádět vícerozměrné grafické simulace. Také tyto nástroje jsou ve výběru nástrojů využitých v~této bakalářské práci.

Popis nástroje MATLAB lze nalézt v~kapitole \ref{matlab-desc}.
\subsection{Modelica}
\label{modelica-lang}
Jazyk Modelica je objektově orientovaný, modelační a simulační jazyk, který je vyvíjen neziskovou organizací Modelca Association od roku 1997. Díky tomu, že je tento jazyk volně dostupný, je na trhu mnoho simulačních nástrojí a vývojových prostředí, které pracují právě s~tímto jazykem. Pro účely této práce byly vybrány nástoje Dymola, OpenModelica a jModelica.org. Vývojové prostředí Dymola není, stejně jako MATLAB, volně dostupné. Pro účely provádění experimentů s~tímto vývojovým prostředím je využita licence, pomocí které je možno spustit nástroj Dymola na školním serveru Merlin v~rámci VUT FIT.

Modely, které jsou zapsány v~jazyku Modelica, mají veškeré své chování popsané rovnicemi. Například rovnice Newtonova zákona ochlazování, který má matematický zápis:

\begin{equation}
    mc_p\Dot{T} = hA(T_{\infty} - T)
\end{equation}

se v~jazyce Modelica zapíše naprosto totožným způsobem \cite{modelica-example}. Rovnice má tedy po zapsání následující tvar:

\begin{verbatim}
                        m*c_p*der(T) = h*A*(T_inf-T)
\end{verbatim}

Pro to, aby byl model funkční, je nutné definovat vstupní hodnoty jednotlivých proměnných. Zapsaná rovnice se tedy chová naprosto stejně, jako když počítáme rovnici na papíře. Použítím znaku $ = $ tedy nedochází k~přiřazení, jako je to běžné u~jiných programovacích jazyků, ale slouží zde jako znak pro porovnání - proto tedy ona práce s~rovnicemi.

Jazyk je v~současnosti velmi využíván v~oblasti proudění kapalin a termodynamiky, vzhledem k~velmi jednoduchému vytvoření modelu podle předem stanovených rovnic. Dále se pak používá ve větší míře v~elektrotechnice a strojírenství.

Stejně jako jazyk MATLAB, i Modelica podporuje grafický přehled výsledků pomocí grafů. I~v~tomto případě jsou v~kapitole \ref{kapitola5} grafy vytvořeny pomocí vestavěného nástroje pro tvorbu grafů v~jazyce Modelica.

\subsection{Python}
Python je volně dostupný interpretovaný programovací jazyk, který má nepřeberné množství využití. Poprvé byl představen v~roce 1991. Jazyk Python není v~základním pojetí simulačním nebo modelačním jazykem. Tuto funkcionalitu získává teprve s~dodatečnými knihovnami. V~rámci využití v~této bakalářské práci byla vybrána rodina knihoven SciPy. Hlavním přínosem této rodiny knihoven je možnost použití metod integrace, lineární algebry, rychlé Fourierovy transformace a řešení diferenciálních rovnic.

Tento jazyk byl zvolen z~důvodu, který byl řečený výše. Python nemá primární použití jako jazyk vhodný pro modelování a simulace. Nicméně s~jeho rostoucí popularitou a rostoucí uživatelskou základnou, bude jeho využití růst ještě více. Momentálně má Python velmi široký záběr pokrytí - od funkcionální, přes logické programování, až po tvorbu grafiky, databází, nebo provádění simulací. Jazyk je využíván velkými firmami na trhu, jako jsou například Google, NASA nebo Wikipedia. Velmi často je v dnešní době využíván k implementaci strojového učení \cite{kirk2017thoughtful}.

Jako simulační knihovny k~tomuto jazyku byla vybrána rodina knihoven SciPy \cite{scipy} \cite{Nunez-Iglesias:2017:ESA:3169538}. Pomocí těchto knihoven je následně možné prováděť náročnější matematické operace, simulace a vizualizaci dat. Bližší popis této knihovny je k~nalezení v~kapitole \ref{chapter-scipy}.

Stejně jako u~jazyků MATLAB a Modelica jsou grafy vykreslené v~jazyce Python využity k~zobrazování výsledků simulací v~kapitole \ref{kapitola5}.

\chapter{Popis použitých simulačních nástrojů}
\label{kapitola3}

Obsahem této kapitoly je rozdělení zvolených simulačních nástrojů, které lze nalézt v kapitole \ref{rozdeleni-nastroju}. Následující podkapitola \ref{popis-nastroju} obsahuje bližší popis jednotlivých nástrojů společně s jejich výhodami a zajímavostmi. Vybranými nástroji pro porovnání v rámci bakalářské práce jsou:
\begin{itemize}
    \item MATLAB
    \item GNU Octave
    \item SciLab
    \item Freemat
    \item Dymola
    \item OpenModelica
    \item jModelica
    \item Python + SciPy
\end{itemize}

Nástroje byly vybrány tak, aby všechny byly volně dostupné a zároveň podporovaly alespoň jeden jazyk ze zvolených v kapitole \ref{popis-jazyky}. Nicméně dva nástroje z výběru nejsou primárně volně dostupné. Prvním z nich je MATLAB, u kterého je volná dostupnost zaručena využitím 30 denní zkušební verze, která je zdarma ke stažení. Druhým takovým nástrojem je Dymola, u které je dostupnost zaručena díky školní licenci VUT FIT a je dostupná na serveru Merlin. I zde je dostupná zkušební verze zdarma po omezenou dobu.

\section{Rozdělení použitých simulačních nástrojů}
\label{rozdeleni-nastroju}

Zvolené simulační nástroje můžeme rozdělit podle mnoha kritérií. V tabulce \ref{tab:rozdeleni-nastroju} lze nalézt dělení podle základních vlastností, jako jsou jazyk, dostupnost, nebo podporované platformy. Jak je z tabulky patrné, všechny nástroje jsou spustitelné na všech běžných platformách (Windows, Linux, MacOS), kromě nástroje Dymola popsán v~kapitole \ref{dymola-desc}, který je spustitelný pouze v~prostředí Windows a Linux. Všechny v tabulce zmíněné nástroje mají také do určité míry vlastní grafické prostředí, až na nástroj SciPy, který je popsán v~kapitole \ref{chapter-scipy}. 
\begin{savenotes}
\begin{table}[]
\centering
\resizebox{\textwidth}{!}{%
\begin{tabular}{|l|l|l|l|l|l|l|l|l|}
\hline
                                                                                                    & MATLAB                                                                                                          & GNU Octave & SciLab & Freemat & Dymola           & OpenModelica                                             & jModelica & Python + SciPy \\ \hline
Jazyk                                                                                               & MATLAB                                                                                                          & MATLAB     & MATLAB & MATLAB  & Modelica         & Modelica                                                 & Modelica  & Python         \\ \hline
Grafické prostředí                                                                                  & Ano                                                                                                             & Ano        & Ano    & Ano     & Ano              & Ano                                                      & Ano       & Ne             \\ \hline
Platforma                                                                                           & Vše                                                                                                             & Vše        & Vše    & Vše     & Windows, Linux   & Vše\footnote{Často nestabilní na MacOS} & Vše       & Vše            \\ \hline
Podpora jiných jazyků                                                                               & Ano                                                                                                             & Ano        & Ano    & Ano     & Ano              & Ano                                                      & Ano       & Ano            \\ \hline
Možnost online aplikace                                                                                     & Ano                                                                                                             & Ano        & Ano    & Ne      & Ne               & Ne                                                       & Ne        & Ano            \\ \hline
Dostupnost                                                                                          & Komerční licence\footnote{Pro účely bakalářské práce použita 30 denní zkušební licence zdarma} & Zdarma     & Zdarma & Zdarma  & Komerční licence & Zdarma                                                   & Zdarma    & Zdarma         \\ \hline
Opensource\footnote{Volně dostupné zdrojové kódy, například na serveru github.com} & Ne                                                                                                              & Ne         & Ano    & Ano     & Ne               & Ano                                                      & Ne        & Ano            \\ \hline
\end{tabular}%
}
\caption{Přehled základních vlastností simulačních nástrojů}
\label{tab:rozdeleni-nastroju}
\end{table}
\end{savenotes}



\section{Popis použitých nástrojů}
\label{popis-nastroju}
V následující kapitole jsou podrobně popsány simulační nástroje využité v rámci bakalářské práce. 
\subsection{MATLAB a Simulink}
\label{matlab-desc}

Simulační nástroj MATLAB, je stejně jako jazyk MATLAB, který je popsán v~kapitole \ref{matlab-lang}, uzavřený nástroj vyvíjený společností MathWorks. Tento simulační nástroj je mateřským prostředím pro nástroj Simulink, který je také součástí této kapitoly.

Nástroj umožňuje modelování modelů a následné simulace s~nimi. Tento nástroj nabízí široký záběr možností využití, od matematických výpočtů, přes použití pro eknomii, až po využití pro genetické algoritmy ve strojírenství \cite{Zapletal2016}.

MATLAB má také vlastní rozhraní pro plnohodnotnou webovou instanci tohoto simulačního programu\footnote{\url{https://www.mathworks.com/products/matlab-online.html}}. Pomocí tohoto webového nástroje je možné svůj kód/model sdílet společně s~dalšími uživateli a tak společně pracovat na jednom projektu. Porovnání a zhodnocení webového rozhraní nejsou v~této bakalářské práci zapracovány.

\begin{figure}
    \centering
    \includegraphics[width=15cm]{obrazky-figures/dummy.png}
    \caption{Ukázka prostředí MATLAB}
    \label{fig:matlab}
\end{figure}

Simulink je programovatelná grafická nástavba pro nástroj MATLAB. Tento nástroj je také vyvíjen společností MathWorks. Hlavní využití nástroje je jednoduché vymodelování systému pomocí grafických programovatelných bloků, respektive blokových schemat. Pro tyto účely jsou v~rámci nástroje Simulink předem vytvořeny a předdefinovány bloky pro tvorbu dynamických a spojitých modelů. Další výhodou je přímé generování kódu v~jazyce C, případně v~jazyce C++. Běh simulací s~takto vytvořenými modely je možné sledovat v~reálném čase.

Nástroj MATLAB bohužel není volně dostupný, nicméně v~akademickém prostředí je velmi běžně k~dostání, stejně jako v~následné praxi. Pro účely bakalářské práce je však využita běžná 30 denní zkušební licence, dostupná zdarma z webových stránek společnosti MathWorks\footnote{\url{https://www.mathworks.com/campaigns/products/trials.html?procode=ML}}, ve verzi MATLAB\_R2019a.

Simulink je, stejně jako MATLAB, uzavřený a komerční nástroj. Jako volně dostupnou alternativu bychom mohli považovat nástroj OpenModelica, který je popsán v~kapitole \ref{openmodelica-desc}.

\subsection{GNU Octave}
\label{octave-desc}
Nástroj Octave je vyvíjený pod veřejnou licencí GNU General Public Licence (GPL) \cite{OctaveManual}. Syntax jazyka, který je použit k~modelování v~GNU Octave je velmi podobný jazyku MATLAB, dokonce je s~tímto jazykem ve větší části kompatibilní. Hlavním rozdílem v~syntaxi je ten, že Octave podporuje autoinkrementaci stejně, tak jako například jazyk C -- MATLAB tuto podporu bohužel nemá.
Mezi další rozdíly patří již jen drobně odlišné syntaktické zápisy, případně volání jinak pojmenovaných funkcí, například pro matematickou operaci umocňování se v~Octave používá zápis \texttt{a\^\space b} nebo \texttt{a**b}, zatímco v~MATLABu je možné tuto operaci zapsat pouze jako \texttt{a\^\space b} \cite{OctaveManual}.

Hlavní výhodou nástroje GNU Octave je, jak už bylo nastíněno výše, že je volně otevřený a zdarma. Tento nástroj má poměrně širokou komunitu uživatelů, kteří vyvíjí další rozšiřující balíčky pro potřeby simulací, matematiky, statistiky a dalších jiných vědeckých odvětví\footnote{\url{https://octave.sourceforge.io/packages.php}}.

\todo{instalace, pouzita verze}

\subsection{SciLab}
\label{scilab-desc}
Další z~nástrojů, který je volně dostupnou alternativou MATLABu, je SciLab. Syntax jeho jazyka je zase podobný syntaxu MATLABu, ovšem už ne do takové míry, jako u~nástroje GNU Octave \cite{Gilberto}. Kód napsaný pro SciLab tedy není volně přenositelný do prostředí MATLABu, ale díky velké podobnosti syntaxe je možné kód snadno refaktorovat pro tento simulační nástroj.

Podobně jako u~MATLABu, i nástroj SciLab nabízí možnost využití vlastního webového rozhraní\footnote{\url{https://www.scilab.org/cloud/web-application}}. Přítomnost této možnosti používání bych označil za velkou výhodu oproti jiným volně dostupným nástrojům. Ani pro tento nástroj nebude tato možnost více rozebírána v~rámci této bakalářské práce.

\todo{instalace, pouzita verze}

\subsection{Freemat}
\label{freemat-desc}
\todo{freemat here}

\subsection{Dymola}
\label{dymola-desc}

Nástroj Dymola je uzavřený komerční nástroj vyvíjený firmou Dassault Systèmes. Tento simulační nástroj je založený, jak už bylo řečeno v~rozdělení v~kapitole \ref{popis-nastroju}, na jazyce Modelica. Dymola umožňuje jednoduché vytvoření modelu a pak následně provádení simulací s~ním. Tento nástroj je velmi využíván ve strojírenství, elektrotechnice a energetice\footnote{\url{https://www.3ds.com/products-services/catia/products/dymola/key-advantages/}}

\begin{figure}
    \centering
    \includegraphics[width=15cm]{obrazky-figures/dummy.png}
    \caption{Ukázka prostředí Dymola}
    \label{fig:dymola}
\end{figure}

Pro účely této bakalářské práce je využita instalace nástroje Dymola ve verzi \todo{verze} na školním serveru Merlin. Dymola má také k dispozici, stejně jako MATLAB, zkušební časově omezenou verzi zdarma. Nicméně pro účely srovnání mi přišlo zajímavé využít právě školní licenci, která je daleko více přístupné pro případné využití studenty.


\subsection{jModelica}
Jednou z~možných alternativ k~nástroji Dymola je jModelica. Tento nástroj je volně dostupný, otevřený a stejně jako GNU Octave, který byl popsán v~kapitole \ref{octave-desc}, vyvíjený pod licencí GPL. Je jedním z~vyhledávaných alternativ pro nástroj Dymola. Z~obrázků \ref{fig:dymola} a \ref{fig:jmodelica} je patrné, že i grafické rozdíly v~GUI jednotlivých nástrojů nejsou nijak markantní.

jModelica podporuje přímé generování ze zdrojového kódu napsaného v~jazyce Modelica do jazyků C a XML. Tato funkcionalita je velmi přínosná, pokud například chceme využívat nástroj jModelica jen jako modelační prostředek a následné simulace spouštět v~jiném prostředí. Dále také podporuje využití jazyka Python a jeho knihoven.

Pro potřeby bakalářské práce je využit balík Assimulo\footnote{\url{https://jmodelica.org/assimulo/}}, pomocí kterého je možné řešit diferenciální rovnice. Tento balík funkcí je napsán právě v~jazyce Python.

\begin{figure}
    \centering
    \includegraphics[width=15cm]{obrazky-figures/dummy.png}
    \caption{Ukázka prostředí jModelica.org}
    \label{fig:jmodelica}
\end{figure}

\todo{instalace, pouzita verze}

\subsection{OpenModelica}
\label{openmodelica-desc}
Simulační nástroj OpenModelica je vyvíjena společenstvím autorů známých pod jménem Open Source Modelica Consortium (OSMC). OpenModelica má jako jeden ze dvou vybraných nástrojů volně dostupné zdrojové kódy\footnote{\url{https://github.com/OpenModelica}}. Tato skutečnost nahrává k~vývoji vlastních modifikací a uživatelských pluginů.

Obecně se nástroj OpenModelica udává jako jedna z~alternativ pro prostředí MATLAB + Simulink. Další takovou alternativou je nástroj SciLab popsaný v~kapitole \ref{scilab-desc}.

\todo{instalace, pouzita verze}

\subsection{SciPy}
\label{chapter-scipy}
Tento simulační nástroj jako jediný není založený na jazycích MATLAB, či Modelica, nýbrž na skriptovacím jazyce Python. Není to simulační nástroj v~pravém slova smyslu, jedná se spíše o~rozšiřující knihovny jazyka Python, které jsou zdarma a volně dostupné\footnote{\url{https://github.com/scipy/scipy}} \cite{scipy}. V~rámci této rodiny knihoven jsou knihovny:
\begin{itemize}
    \item SciPy -- tato knihovna obsahuje numerické algoritmy pro provádění simulací, zpracovávání signálů a následné statistické vyhodnocení simulace
    \item NumPy -- obsahuje metody pro numerické výpočty, práci s~číselnými poly a maticemi
    \item Matplotlib -- pomocí této knihovny je možné na základě vstupních dat vykreslovat grafické výstupy ve 2D a i ve 3D
\end{itemize}

SciPy nemá žádné vlastní grafické prostředí pro tvorbu modelů a následný průběh simulací probíhá proto v~běžném IDE pro vývoj kódu v~jazyce Python.

\todo{instalace, pouzita verze}

\chapter{Popis modelů a použité metodiky}
\label{kapitola4}
V této kapitole bude představena použitá porovnávací metodika, kritéria hodnocení a následné způsoby jejich vyhodnocení. Tato metodika bude následně použita pro vyhodnocení výsledků získaných z běhu simulací s modely, které jsou také popsány v této kapitole. Zároveň s popisem modelů lze v této kapitole najít i popis jejich implementace a popis nastalých problémů během ní.

\section{Popis použité metodiky}

Předlohou k tvorbě vyhodnocovací metodiky sloužila metodika ke srovnávání nástrojů simulujících dopravní situace na pozemních komunikacích \cite{jones2004traffic}. Původní převzatá metodika sledovala kritéria jako hardware a software náročnost, náročnost na kvalitu vstupních dat a pak další kritéria ve vztahu k použitým nástrojům. Pro účely bakalářské práce byla vybraná metodika modifikována podle potřeb zadání a následně byla vytvořena tato kritéria:
\begin{itemize}
    \item Strojový čas -- čas, po který simulace běží na výpočetním stroji.
    \item Přesnost zvolené numerické metody -- k určené přesnosti výpočtu se bude sledovat počet kroků výpočtu. Tyto hodnoty se budou následně porovnávat a hodnotit.
    \item Hardwarové a softwarové požadavky -- v rámci tohoto kritéria bude hodnocena kompatibilita nástrojů napříč standardními platformami (Windows, Linux, MacOS), případně zde budou uvedeny omezení, která vyplynou z instalace a běhu experimentu.
    \item Obtížnost implementace modelu -- u tohoto kritéria lze namítat, že je velmi subjektivní. Obecně lze předpokládat, že pokud budou vybrány základní typy modely pro různé druhy simulací, bude obtížnost implementace nízká, pokud bude jazyk, nebo nástroj, vhodný pro tuto implementaci. V opačném případě bude obtížnost implementace označena jako vysoká.
    \item Obtížnost instalace -- všechny nástroje byly nainstalovány pomocí návodů v oficiálních dokumentacích. Nebylo-li tomu tak, pak v rámci hodnocení obtížnosti instalace jsou uvedena úskalí vyvstalá během instalace.
\end{itemize}

V rámci hodnocení nebudeme používat žádnou škálu, k hodnocení "úspěšnosti" simulačního nástroje. Výsledek hodnocení bude spíše doporučení, jestli je daný simulační nástroj, případně jazyk, vhodný pro daný typ úloh.


\section{Implementované modely}
\label{implementace}
V následující kapitole jsou popsány jednotlivé modely a jejich implementace pro potřeby běhu experimentu v simulačních nástrojích. Společně s implementací jsou popsány zjištěné problémy během implementování a jejich řešení. 

\subsection{Skákající míček}
V rámci této implementace je namodelován systém skákajícího míčku, který je z nedokonale pružného materiálu a postupně během skoků ztrácí svou rychlost a výšku odrazu. Míček je vypouštěn z výšky $h$, postupně nabere rychlost $v_p$ a narazí do země. Takový model lze popsat jednoduchou diferenciální rovnicí, která má znění:

\begin{equation}
    h' = v_p
\end{equation}
\begin{equation}
    v_p ' = -9.81
\end{equation}

s počáteční podmínkou $h(0) = 10$. Pro účely experimentu jsou další počáteční hodnoty nastaveny takto:

\begin{center}
\begin{table}[ht]
    \centering
\begin{tabular}{|l|l|l|}
\hline
Proměnná             & Hodnota & Jednotka    \\ \hline
$h$                    &   10     & $m$     \\ \hline
$v_p$                   &    15   & $m.s^{-1}$ \\ \hline
koeficient pružnosti &  0.8    &             \\ \hline
\end{tabular}
    \caption{Vstupní hodnoty modelu skákajícího míčku}
    \label{tab:micek-hodnoty}
\end{table}
\end{center}

Po každém dopadu se vypočítá nová výška, do které míček vyletí a nová rychlost, kterou míček dopadne na zem. Tyto vypočtené hodnoty se následně použijí pro výpočet další iterace. 

Pro implementaci posloužil jako základ kód pro jazyk MATLAB převzatý z oficiální dokumentace MathWorks pro nástroj MATLAB\footnote{\url{https://www.mathworks.com/help/stateflow/ug/modeling-a-bouncing-ball-in-continuous-time.html}}.

Během implementace v Pythonu se vyskytl problém s detekcí výšky a výpočtu následného odrazu. Původní zvolená metoda \texttt{odeint()} byla vyhodnocena jako nevhodná z důvodu nemožnosti výpočtu derivace rychlosti v bodě $h\leq0$. Po několika neúspěšných pokusech s touto a dalšími metodami byla zvolena metoda \texttt{solve\_ivp()}, která tyto situace umí do jisté míry detekovat a hodnotu derivace vypočítat. Bohužel i při použití této metody vznikají velké nepřesnosti a během trvání výpočtu narůstá chyba výpočtu. Po několika krocích výpočtu se hodnota výšky míčku, místo přibližování se k 0, "propadne"\space do záporných hodnot. Tento jev se vyskytuje právě kvůli kumulované chybě, způsobenou zvolenou metodou.

Při implementaci a následného zkoumání výsledků simulace v jazyce Modelica se jev, kdy se míček "propadne pod zem", objevuje také. Zde je to způsobeno zřejmě přesností výpočtu a následnou práci s velmi malými čisly. Nicméně na průběh výpočtu, navzdory implementace v Pythonu, tento jev nemá vliv na výpočet.

Výsledky implementovaného modelu a následné srovnání výsledků simulačních nástrojů lze nalézt v kapitole \ref{srovnani-micek}.
Zvolený model byl implementován pro všechny nástroje popsané v kapitole~\ref{popis-nastroju}.

\subsection{Kruhový test}
\label{kruhovy-test}

Kruhový test je implementován podle návodu ze studijní opory pro předmět IMS - Modelování a simulace \cite{IMS-skripta}. Jedná se o implementaci řešení jednoduché soustavy diferenciálních rovnic. Systém, který byl modelován je zadán soustavou diferenciálních rovnic:

\begin{equation}
   x' = y
\end{equation}
\begin{equation}
    y' = -x
\end{equation}
a počáteční podmínka rovnice je zadána jako $y(0) = 1$ a $x(0) = 0$.

Během běhu simulace se výsledky postupně přibližují analytickému řešení, které je definováno jako:

\begin{equation}
    y(t) = \cos(t)
\end{equation}


Implementace v jazyce Modelica proběhla velmi snadno. Jak bylo popsáno v kapitole \ref{modelica-lang}, zápis v tomto jazyce připomíná zápis výpočtu na papír. \todo{odlisnosti pro jednotlive nastroje}

Pro implementaci v Pythonu byla využita metoda \texttt{odeint()} z knihovny \texttt{scipy.integrate}\footnote{\url{https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html}}, která je vytvořena pro řešení diferenciálních rovnic a jejich soustav. Pro účely využití této metody je potřeba si definovat obslužnou funkci pro výpočet nových stavů integrátorů. Pro implementaci v tomto případě nebyla využita Eulerova metoda podle příkladu ze studijní opory, neboť rodina knihoven SciPy nemá tuto metodu implementovánu a je doporučeno využívat právě metodu \texttt{odeint()}, případně metodu \texttt{solve\_ivp()} ze stejné rodiny knihoven.

Tento model byl implementován také v jazyce MATLAB. K výpočtu byla využita standardní funkce pro výpočet diferenciálních rovnic \texttt{dsolve()}. Během studování výpisů ze standardního výstupu jsem objevil, že MATLAB přímo vypočítává i výsledek analytického řešení, ke kterému by měl výpočet konvergovat. \todo{odlisnosti pro jednotlive nastroje}


\subsection{Tuhý systém}
Tuhý systém\footnote{Z anglického "stiff system"} je systém, který je popsán matematickou rovnicí, kterou lze označit za tuhou \cite{hairer}. Tuhá rovnice je diferenciální rovnice, která má při řešení určitými numerickými metodami numericky nestabilní řešení. Systémy, které můžeme označit za tuhé, můžeme najít například v rámci chemických reakcí. Tato nestabilita je způsobena vysokou hodnotou délky kroku při řešení rovnice. Pro řešení se většinou používají jednokrokové metody pro výpočty diferenciálních rovnic. Obvykle je k řešení využita některá z varianty metod Runge-Kutta, nebo i jednoduchá Eulerova metoda \cite{IMS-skripta}. Při výpočtu vícekrokovou metodou se využívají například metody Adamsova, nebo Nyströmova. Využití vícekrokových metod je ale velmi vzácné a podle literatury popisováno jako méně stabilní, než jednokrokové metody \cite{hairer}. Pro účely experimentu byla vybrána rovnice:

\begin{equation}
    y' = -50(y - \cos{(x)})
\end{equation}
s délkou kroku $h = \frac{1.875}{50}$ a počáteční podmínkou $y(0) = 0$. Pokud by byla délka kroku $h$ větší než $\frac{2}{50}$, pak by došlo k nestabilitě a k oscilování okolo kýženého výsledku \cite{hairer}.

V jazyce Python, konkrétně tedy s využitím knihovny SciPy, se během implementace vyskytl problém s volbou zvolené metody výpočtu zvolené diferenciální rovnice. Většina metod pro výpočet diferenciálních je implementována tak, že předem detekují, zda-li je zadaná rovnice tuhá, či nikoliv. Pokud ji vyhodnotí jako tuhou, pak si metoda sama upraví velikost kroku na tolik, aby se výsledek co nejvíce přiblížil analytickému řešení. Při zvolení metody, která tuto detekci před výpočtem neobsahuje, vypisuje metoda chybu při zjištění "tuhosti" rovnice a následné oscilace výsledku okolo analytického řešení. Po studiu možných metod byla nakonec vybrána metoda \texttt{odeint()}, která obsahuje detekci pro tuhé rovnice a jejich soustavy.

\todo{modelica - asi bez problemu, nutno dohledat}

\todo{matlab - vyuziti ode125}

Výsledky běhů simulace implementovaných modelů lze nalézt v kapitole \ref{srovnani-tuhy}. V této kapitole je také porovnání využitých nástrojů.

\chapter{Výsledky simulací a porovnání výsledků}
\label{kapitola5}
V této kapitole lze nalézt výsledky z experimentů a následné vyhodnocení porovnání simulačních nástrojů. Každý z modelů, které byly popsány v kapitole \ref{implementace}, byl postupně implementován ve všech nástrojích uvedených v kapitole \ref{popis-nastroju}. Pokud tomu tak nebylo, pak je to zohledněno v jeho hodnocení obtížnosti implementace.

\section{Model 1}
\label{srovnani-micek}


\begin{table}[ht]
\centering
\begin{tabular}{|l|l|l|l|}
\hline
             & Rychlost výpočtu {[}s{]} &  &  \\ \hline
MATLAB       &                          &  &  \\ \hline
GNU Octave   &                          &  &  \\ \hline
SciLab       &                          &  &  \\ \hline
Dymola       &                          &  &  \\ \hline
OpenModelica &                          &  &  \\ \hline
jModelica    &                          &  &  \\ \hline
Scipy        &                          &  &  \\ \hline
             &                          &  &  \\ \hline
\end{tabular}
\caption{Průměrná rychlost výpočtu v sekundách pro model 1. Průměr byl počítán z 50 měření.}
\label{tab:micek-tabulka}
\end{table}

\section{Model 2}
\label{srovnani-kruh}


\begin{table}[ht]
\centering
\begin{tabular}{|l|l|l|l|}
\hline
             & Rychlost výpočtu {[}s{]} &  &  \\ \hline
MATLAB       &                          &  &  \\ \hline
GNU Octave   &                          &  &  \\ \hline
SciLab       &                          &  &  \\ \hline
Dymola       &                          &  &  \\ \hline
OpenModelica &                          &  &  \\ \hline
jModelica    &                          &  &  \\ \hline
Scipy        &       0.065              &  &  \\ \hline
             &                          &  &  \\ \hline
\end{tabular}
\caption{Průměrná rychlost výpočtu v sekundách pro model 1. Průměr byl počítán z 50 měření.}
\label{tab:kruh-tabulka}
\end{table}

\subsection{Shrnutí}

\section{Model 3}
\label{srovnani-tuhy}


\begin{table}[ht]
\centering
\begin{tabular}{|l|l|l|l|}
\hline
             & Rychlost výpočtu {[}s{]} &  &  \\ \hline
MATLAB       &                          &  &  \\ \hline
GNU Octave   &                          &  &  \\ \hline
SciLab       &                          &  &  \\ \hline
Dymola       &                          &  &  \\ \hline
OpenModelica &                          &  &  \\ \hline
jModelica    &                          &  &  \\ \hline
Scipy        &                          &  &  \\ \hline
             &                          &  &  \\ \hline
\end{tabular}
\caption{Průměrná rychlost výpočtu v sekundách pro model 1. Průměr byl počítán z 50 měření.}
\label{tab:tuhy-tabulka}
\end{table}

\section{Model 4}

\section{Model 5}


\section{Shrnutí}




\chapter{Závěr}
\label{kapitola6}


%===============================================================================
